services:
  slskd:
    image: slskd/slskd:latest
    container_name: slskd
    hostname: slskd
    
    ports:
      - "5030:5030"      # Web UI
      - "5031:5031"      # HTTPS
      - "50300:50300"    # Soulseek

    environment:
      # Тільки вказуємо шлях до конфігу і часовий пояс
      - TZ=Europe/Kyiv
      - SLSKD_CONFIG=/config/slskd.yml

    volumes:
      # Конфігурація (read-only для безпеки)
      - ./slskd/config:/config:ro

      # Дані додатку
      - ./slskd/app:/app

      # Завантаження
      - ./slskd/downloads:/var/slskd/downloads
      - ./slskd/incomplete:/var/slskd/incomplete

      # Ваша музика для шарингу
      - /Users/okravch/my/music/soulseek:/var/slskd/shared:ro

    restart: unless-stopped

    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 2G
        reservations:
          cpus: '0.5'
          memory: 512M

    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:5030/health" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
